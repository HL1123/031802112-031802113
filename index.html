<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>

<body>
    <div id="app">
        <el-row :gutter="10">
            <el-col :span="8">
                <el-input type="textarea" :rows="25" placeholder="导师：张三
2016级博士生：天一、王二、吴五
2015级硕士生：李四、王五、许六
2016级硕士生：刘一、李二、李三
2017级本科生：刘六、琪七、司四
        
刘六：JAVA、数学建模
        
李二：字节跳动、京东云" v-model="inputData">
                </el-input>
                <br><br>
                <el-button type="primary" @click="processInput" style="display:block;margin:0 auto">生成家族树</el-button>
                <div class="grid-content"></div>
            </el-col>
            <el-col :span="16">
                <el-input placeholder="输入关键字进行过滤" v-model="filterText">
                </el-input>
                <el-tree class="filter-tree" :data="data" :props="defaultProps" node-key="id" default-expand-all
                    :filter-node-method="filterNode" @node-drag-start="handleDragStart"
                    @node-drag-enter="handleDragEnter" @node-drag-leave="handleDragLeave"
                    @node-drag-over="handleDragOver" @node-drag-end="handleDragEnd" @node-drop="handleDrop" draggable
                    :allow-drop="allowDrop" :allow-drag="allowDrag" ref="tree">
                </el-tree>
                <div class="grid-content"></div>
            </el-col>
        </el-row>
    </div>
</body>
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script>
    let id = 1000;
    var Main = {
        watch: {
            filterText(val) {
                this.$refs.tree.filter(val);
            }
        },

        methods: {
            filterNode(value, data) {
                if (!value) return true;
                return data.label.indexOf(value) !== -1;
            },

            processInput() {
                const newChild = {label: this.inputData, children: []};
                this.data.push(newChild);
                this.data[this.treeCount++].children[0].children.push(newChild);
                console.log(this.data);
            }
        },

        data() {
            return {
                treeCount: -1,
                inputData: '',
                filterText: '',
                data: [],
                data: [{
                    label: '一级 1',
                    children: [{
                        label: '二级 1-1',
                        children: [{
                            label: '三级 1-1-1'
                        }]
                    }]
                }, {
                    label: '一级 2',
                    children: [{
                        label: '二级 2-1',
                        children: [{
                            label: '三级 2-1-1'
                        }]
                    }, {
                        label: '二级 2-2',
                        children: [{
                            label: '三级 2-2-1'
                        }]
                    }]
                }, {
                    label: '一级 3',
                    children: [{
                        label: '二级 3-1',
                        children: [{
                            label: '三级 3-1-1'
                        }]
                    }, {
                        label: '二级 3-2',
                        children: [{
                            label: '三级 3-2-1'
                        }]
                    }]
                }],
                defaultProps: {
                    children: 'children',
                    label: 'label'
                }
            };
        }
    };
    var Ctor = Vue.extend(Main)
    new Ctor().$mount('#app')
</script>
<!-- <script>
    new Vue({
        el: '#app',
        data: function () {
            return { visible: false }
        }
    })
</script> -->

</html>